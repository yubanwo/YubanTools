var N=Object.defineProperty,A=Object.defineProperties;var D=Object.getOwnPropertyDescriptors;var P=Object.getOwnPropertySymbols;var q=Object.prototype.hasOwnProperty,j=Object.prototype.propertyIsEnumerable;var T=(a,t,e)=>t in a?N(a,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[t]=e,S=(a,t)=>{for(var e in t||(t={}))q.call(t,e)&&T(a,e,t[e]);if(P)for(var e of P(t))j.call(t,e)&&T(a,e,t[e]);return a},_=(a,t)=>A(a,D(t));var b=(a,t,e)=>new Promise((r,c)=>{var d=o=>{try{u(e.next(o))}catch(m){c(m)}},n=o=>{try{u(e.throw(o))}catch(m){c(m)}},u=o=>o.done?r(o.value):Promise.resolve(o.value).then(d,n);u((e=e.apply(a,t)).next())});import{c as x,u as E,T as I,d as k,$ as s,i as L,e as y,j as B,R as z,s as $}from"./bootstrap-eRMf25wG.js";import{a3 as C,W as J,J as R,ad as F,aj as M,m as f,af as h,ag as v,a9 as l,ap as O,b1 as W,am as w,aw as g,O as V,ae as G}from"../jse/index-index-QIcGCnph.js";const H=C({name:"ForgetPassword",__name:"reset-password",props:{formSchema:{},loading:{type:Boolean,default:!1},loginPath:{default:"/auth/login"},title:{default:""},subTitle:{default:""},submitButtonText:{default:""}},emits:["submit"],setup(a,{expose:t,emit:e}){const r=a,c=e,[d,n]=x(J({commonConfig:{hideLabel:!0,hideRequiredMark:!0},schema:R(()=>r.formSchema),showDefaultActions:!1})),u=E();function o(){return b(this,null,function*(){const{valid:i}=yield n.validate(),p=yield n.getValues();i&&c("submit",p)})}function m(){u.push(r.loginPath)}return t({getFormApi:()=>n}),(i,p)=>(F(),M("div",null,[f(I,null,{desc:h(()=>[v(i.$slots,"subTitle",{},()=>[w(g(i.subTitle||l(s)("authentication.resetPasswordSubtitle")),1)])]),default:h(()=>[v(i.$slots,"title",{},()=>[w(g(i.title||l(s)("authentication.resetPassword")),1)])]),_:3}),f(l(d)),O("div",null,[f(l(k),{class:W([{"cursor-wait":i.loading},"mt-2 w-full"]),"aria-label":"submit",onClick:o},{default:h(()=>[v(i.$slots,"submitButtonText",{},()=>[w(g(i.submitButtonText||l(s)("authentication.sendReset")),1)])]),_:3},8,["class"]),f(l(k),{class:"mt-4 w-full",variant:"outline",onClick:p[0]||(p[0]=K=>m())},{default:h(()=>[w(g(l(s)("common.back")),1)]),_:1})])]))}}),Y=C({__name:"reset-password",setup(a){const t=L(),e=V(t.query.token);e.value||(y.error({duration:3,description:s("authentication.tokenErrorDesc"),message:void 0}),B.push("/auth/login"));const r=V(!1),c=R(()=>[{component:"VbenInputPassword",componentProps:{passwordStrength:!0,placeholder:s("authentication.password")},fieldName:"password",label:s("authentication.password"),rules:$().min(8,{message:s("authentication.passwordStrength")})},{component:"VbenInputPassword",componentProps:{placeholder:s("authentication.confirmPassword")},dependencies:{rules(n){const{password:u}=n;return $({required_error:s("authentication.passwordTip")}).min(8,{message:s("authentication.passwordTip")}).refine(o=>o===u,{message:s("authentication.confirmPasswordTip")})},triggerFields:["password"]},fieldName:"confirm_password",label:s("authentication.confirmPassword")}]);function d(n){return b(this,null,function*(){try{r.value=!0,yield z(_(S({},n),{token:e.value})),y.success({duration:3,description:s("authentication.resetPasswordSuccessDesc"),message:void 0}),B.push("/auth/login")}finally{r.value=!1}})}return(n,u)=>(F(),G(l(H),{"form-schema":c.value,loading:r.value,onSubmit:d},null,8,["form-schema","loading"]))}});export{Y as default};
